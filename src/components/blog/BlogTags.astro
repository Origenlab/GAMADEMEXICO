---
// =============================================================================
// BlogTags - Nube de etiquetas del blog
// =============================================================================

interface Props {
  tags: Map<string, number>;
  activeTag?: string;
  maxTags?: number;
  titulo?: string;
}

const { tags, activeTag, maxTags = 15, titulo = 'Etiquetas Populares' } = Astro.props;

// Ordenar por cantidad y limitar
const sortedTags = [...tags.entries()]
  .sort((a, b) => b[1] - a[1])
  .slice(0, maxTags);
---

{sortedTags.length > 0 && (
  <div class="blog-tags">
    {titulo && <h4 class="blog-tags__title">{titulo}</h4>}
    <div class="blog-tags__cloud">
      {sortedTags.map(([tag, count]) => (
        <a
          href={`/blog/tag/${encodeURIComponent(tag)}`}
          class={`blog-tag ${activeTag === tag ? 'blog-tag--active' : ''}`}
        >
          {tag}
          <span class="blog-tag__count">{count}</span>
        </a>
      ))}
    </div>
  </div>
)}

<style>
  .blog-tags {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .blog-tags__title {
    margin: 0;
    font-size: var(--font-size-sm);
    font-weight: 600;
    color: var(--color-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .blog-tags__cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .blog-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.35rem 0.75rem;
    border-radius: 4px;
    font-size: var(--font-size-xs);
    font-weight: 500;
    color: var(--color-text);
    background: var(--color-accent);
    text-decoration: none;
    transition: all var(--transition-fast);
  }

  .blog-tag:hover {
    background: var(--color-border);
    color: var(--color-secondary);
  }

  .blog-tag--active {
    background: var(--color-primary);
    color: var(--color-white);
  }

  .blog-tag--active:hover {
    background: var(--color-primary-dark);
    color: var(--color-white);
  }

  .blog-tag__count {
    font-size: 0.625rem;
    opacity: 0.7;
  }

  .blog-tag--active .blog-tag__count {
    opacity: 0.9;
  }
</style>
