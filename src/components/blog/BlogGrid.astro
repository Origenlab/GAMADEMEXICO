---
// =============================================================================
// BlogGrid - Grid responsivo de art√≠culos con header estilo cat√°logo
// =============================================================================

import BlogCard from './BlogCard.astro';
import { calculateReadingTime } from '../../lib/blogHelpers';
import type { CollectionEntry } from 'astro:content';

interface Props {
  posts: CollectionEntry<'blog'>[];
  titulo?: string;
  subtitulo?: string;
  columns?: 2 | 3;
  showViewAll?: boolean;
  viewAllLink?: string;
  viewAllText?: string;
  showCount?: boolean;
  background?: 'white' | 'accent';
  categorySlug?: string;
}

const {
  posts,
  titulo,
  subtitulo,
  columns = 3,
  showViewAll = false,
  viewAllLink = '/blog',
  viewAllText = 'Ver todos',
  showCount = true,
  background = 'accent',
  categorySlug,
} = Astro.props;
---

<section class={`blog-grid-section blog-grid-section--${background}`}>
  <div class="container">
    {(titulo || subtitulo || showViewAll || showCount) && (
      <div class="catalog-header">
        <div class="catalog-header__info">
          {titulo && <h2 class="catalog-header__title">{titulo}</h2>}
          {subtitulo && <p class="catalog-header__desc">{subtitulo}</p>}
        </div>
        <div class="catalog-header__meta">
          {showCount && posts.length > 0 && (
            <div class="catalog-header__count">
              <span class="catalog-header__number">{posts.length}</span>
              <span class="catalog-header__label">{posts.length === 1 ? 'Art√≠culo' : 'Art√≠culos'}</span>
            </div>
          )}
          {showViewAll && (
            <a href={viewAllLink} class="btn btn--outline btn--sm">
              {viewAllText} ‚Üí
            </a>
          )}
        </div>
      </div>
    )}

    {posts.length > 0 ? (
      <div class={`blog-grid blog-grid--${columns}-cols`}>
        {posts.map((post) => (
          <BlogCard
            title={post.data.title}
            description={post.data.description}
            slug={post.id}
            fecha={post.data.fecha}
            categoria={post.data.categoria}
            autor={post.data.autor}
            imagen={post.data.imagen}
            imagenAlt={post.data.imagenAlt}
            tags={post.data.tags}
            destacado={post.data.destacado}
            tiempoLectura={post.data.tiempoLectura}
          />
        ))}
      </div>
    ) : (
      <div class="catalog-empty">
        <div class="catalog-empty__icon">üìù</div>
        <h3 class="catalog-empty__title">No hay art√≠culos disponibles</h3>
        <p class="catalog-empty__text">Pronto publicaremos contenido en esta secci√≥n.</p>
        <a href="/blog" class="btn btn--primary">Ver todos los art√≠culos</a>
      </div>
    )}
  </div>
</section>

<style>
  .blog-grid-section {
    padding: var(--spacing-3xl) 0;
  }

  .blog-grid-section--accent {
    background: var(--color-accent);
  }

  .blog-grid-section--white {
    background: var(--color-white);
  }

  /* CATALOG HEADER - Mismo estilo que p√°ginas de productos */
  .catalog-header {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    padding-bottom: var(--spacing-lg);
    margin-bottom: var(--spacing-xl);
    border-bottom: 2px solid var(--color-primary);
  }

  .catalog-header__info {
    flex: 1;
  }

  .catalog-header__title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-secondary);
    margin: 0 0 0.25rem;
  }

  .catalog-header__desc {
    font-size: 0.9375rem;
    color: var(--color-text-light);
    margin: 0;
  }

  .catalog-header__meta {
    display: flex;
    align-items: center;
    gap: var(--spacing-lg);
  }

  .catalog-header__count {
    text-align: center;
  }

  .catalog-header__number {
    display: block;
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-primary);
    line-height: 1;
  }

  .catalog-header__label {
    font-size: 0.75rem;
    color: var(--color-text-light);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* GRID */
  .blog-grid {
    display: grid;
    gap: var(--spacing-lg);
  }

  .blog-grid--2-cols {
    grid-template-columns: 1fr;
  }

  .blog-grid--3-cols {
    grid-template-columns: 1fr;
  }

  /* EMPTY STATE */
  .catalog-empty {
    text-align: center;
    padding: var(--spacing-3xl) var(--spacing-xl);
    background: var(--color-white);
    border-radius: var(--border-radius);
    border: 2px dashed var(--color-border);
  }

  .catalog-empty__icon {
    font-size: 3rem;
    margin-bottom: var(--spacing-md);
  }

  .catalog-empty__title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-secondary);
    margin: 0 0 0.5rem;
  }

  .catalog-empty__text {
    color: var(--color-text-light);
    max-width: 400px;
    margin: 0 auto var(--spacing-lg);
  }

  @media (min-width: 768px) {
    .catalog-header {
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-end;
    }

    .catalog-header__title {
      font-size: 1.75rem;
    }

    .blog-grid--2-cols {
      grid-template-columns: repeat(2, 1fr);
    }

    .blog-grid--3-cols {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .catalog-header__title {
      font-size: 2rem;
    }

    .blog-grid--3-cols {
      grid-template-columns: repeat(3, 1fr);
    }
  }
</style>
