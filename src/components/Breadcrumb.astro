---
// Breadcrumb component - Migas de pan automáticas
import { generateBreadcrumbs, type BreadcrumbItem } from '../lib/breadcrumb';

interface Props {
  pageTitle?: string;
}

const { pageTitle } = Astro.props;
const pathname = Astro.url.pathname;
const breadcrumbs = generateBreadcrumbs(pathname, pageTitle);

// No renderizar si no hay breadcrumbs (página de inicio)
const showBreadcrumb = breadcrumbs.length > 1;
---

{showBreadcrumb && (
  <nav class="breadcrumb" aria-label="Navegación de migas de pan">
    <div class="container">
      <ol class="breadcrumb__list" itemscope itemtype="https://schema.org/BreadcrumbList">
        {breadcrumbs.map((item, index) => (
          <li
            class={`breadcrumb__item ${item.isActive ? 'breadcrumb__item--active' : ''}`}
            itemprop="itemListElement"
            itemscope
            itemtype="https://schema.org/ListItem"
          >
            {item.isActive ? (
              <span itemprop="name" aria-current="page">{item.name}</span>
            ) : (
              <a href={item.path} class="breadcrumb__link" itemprop="item">
                <span itemprop="name">{item.name}</span>
              </a>
            )}
            <meta itemprop="position" content={String(index + 1)} />
          </li>
        ))}
      </ol>
    </div>
  </nav>
)}

<style>
  .breadcrumb {
    background: var(--color-bg-subtle, #f8f9fa);
    padding: var(--spacing-sm) 0;
    border-bottom: 1px solid var(--color-border, #e5e7eb);
  }

  .breadcrumb__list {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.5rem;
    list-style: none;
    margin: 0;
    padding: 0;
    font-size: var(--font-size-sm);
  }

  .breadcrumb__item {
    display: flex;
    align-items: center;
    color: var(--color-text-light, #6b7280);
  }

  .breadcrumb__item:not(:last-child)::after {
    content: '/';
    margin-left: 0.5rem;
    color: var(--color-text-muted, #9ca3af);
  }

  .breadcrumb__link {
    color: var(--color-text-light, #6b7280);
    text-decoration: none;
    transition: color var(--transition-fast, 0.15s ease);
  }

  .breadcrumb__link:hover {
    color: var(--color-primary, #c7161d);
    text-decoration: underline;
  }

  .breadcrumb__item--active {
    color: var(--color-text, #1f2937);
    font-weight: 500;
  }

  /* Responsive */
  @media (max-width: 640px) {
    .breadcrumb__list {
      font-size: var(--font-size-xs, 0.75rem);
    }
  }
</style>
