---
import Layout from '../../layouts/Base.astro';
import '../../styles/subcategory.css';
import { getCollection } from 'astro:content';
import SubcategoryProductCard from '../../components/SubcategoryProductCard.astro';
import ProductSidebar from '../../components/ProductSidebar.astro';
import RelatedProductsGrid from '../../components/RelatedProductsGrid.astro';
import CotizacionForm from '../../components/CotizacionForm.astro';

// 1. Obtener todos los productos de la categor칤a v치lvulas
const todosProductos = (await getCollection('productos', ({ data }) =>
  data.categoria === 'valvulas'
)).sort((a, b) => a.data.orden - b.data.orden);

// 2. Filtrar por subcategor칤a: V치lvula de Compuerta OS&Y
const productosSubcategoria = todosProductos.filter(p => p.data.subcategoria === 'compuerta');

// 3. Obtener otros productos para secci칩n de relacionados
const otrosProductos = todosProductos.filter(p => !productosSubcategoria.includes(p));

// 4. Definir subcategor칤as para navegaci칩n
const subcategorias = [
  { slug: 'compuerta', nombre: 'V치lvula de Compuerta OS&Y', descripcion: 'Aislamiento en l칤neas principales', activo: true },
  { slug: 'globo', nombre: 'V치lvula de Globo', descripcion: 'Control preciso de presi칩n', activo: false },
  { slug: 'retencion', nombre: 'V치lvula de Retenci칩n', descripcion: 'Prevenci칩n de reflujo', activo: false },
  { slug: 'mariposa', nombre: 'V치lvula Mariposa', descripcion: 'Apertura r치pida 90춿', activo: false },
];
---

<Layout
  title="V치lvula Compuerta OS&Y Bridada | M칠xico"
  description="V치lvula compuerta OS&Y bridada para sistema contra incendio. V치stago exterior, cierre herm칠tico, 175-350 PSI. Certificadas UL/FM. M칠xico."
  activePage="equipos"
  heroTitle="V치lvula de Compuerta OS&Y"
  heroIntro="V치lvulas de compuerta con v치stago exterior y yugo (Outside Screw & Yoke) para aislamiento en l칤neas principales de sistemas contra incendio. El dise침o OS&Y permite verificaci칩n visual instant치nea del estado de apertura, requisito fundamental para cumplimiento de NFPA 25."
  heroBadge="V치lvulas Contra Incendios"
  heroMetrics={[
    { valor: "350", texto: "PSI m치xima" },
    { valor: "2\"-12\"", texto: "Di치metros" },
    { valor: "UL/FM", texto: "Certificaci칩n" }
  ]}
  heroPrimaryText="Ver Cat치logo"
  heroPrimaryLink="#catalogo"
  heroSecondaryText="Solicitar Cotizaci칩n"
  heroSecondaryLink="#cotizar"
  heroShowRightContent={true}
>

  <!-- HERO CONTENT -->
  <Fragment slot="hero-content">
    <p>La <strong>v치lvula de compuerta OS&Y</strong> (Outside Screw & Yoke) es el componente est치ndar para aislamiento en sistemas contra incendio seg칰n NFPA 13, 14 y 20. Su dise침o con v치stago exterior permite verificar visualmente si la v치lvula est치 abierta o cerrada sin necesidad de girarla, caracter칤stica cr칤tica para inspecciones de rutina y respuesta a emergencias. La posici칩n del v치stago tambi칠n facilita la instalaci칩n de interruptores de supervisi칩n para monitoreo remoto.</p>
    <p><strong>Gama de M칠xico</strong> suministra v치lvulas OS&Y bridadas en hierro d칰ctil y bronce con certificaci칩n UL/FM en di치metros de 2" a 12". Cada v치lvula incluye bridas perforadas seg칰n ANSI B16.1 Clase 125 o 250 seg칰n aplicaci칩n. Asesoramos en la selecci칩n del modelo correcto considerando presi칩n de trabajo, material compatible con el medio y requerimientos de supervisi칩n electr칩nica para sistemas monitoreados.</p>
  </Fragment>

  <!-- CONTENT + SIDEBAR -->
  <section class="subcat-content">
    <div class="container">
      <div class="subcat-layout">

        <!-- MAIN CONTENT -->
        <main class="subcat-main">
          <div class="catalog-header">
            <div class="catalog-header__text">
              <h2 class="catalog-header__title">Cat치logo de V치lvulas de Compuerta OS&Y</h2>
              <p class="catalog-header__desc">Selecciona el modelo que mejor se adapte a tu sistema contra incendios</p>
            </div>
            <div class="catalog-header__count">
              <span class="catalog-header__number">{productosSubcategoria.length}</span>
              <span class="catalog-header__label">producto{productosSubcategoria.length !== 1 ? 's' : ''}</span>
            </div>
          </div>

          <!-- Products Grid -->
          <div class="categories__grid">
            {productosSubcategoria.map((producto) => (
              <SubcategoryProductCard
                title={producto.data.title}
                description={producto.data.description}
                brand={producto.data.marca}
                image={producto.data.imagen}
                productSlug={producto.id}
                flow={producto.data.flujo}
                material={producto.data.material}
                certifications={producto.data.certificaciones}
              />
            ))}
          </div>

          <!-- Empty State -->
          {productosSubcategoria.length === 0 && (
            <div class="catalog-empty">
              <div class="catalog-empty__icon">游댌</div>
              <h3 class="catalog-empty__title">Pr칩ximamente m치s opciones</h3>
              <p class="catalog-empty__text">Estamos agregando m치s v치lvulas de compuerta OS&Y de diferentes marcas y especificaciones. Mientras tanto, solicita una cotizaci칩n personalizada.</p>
              <a href="#cotizar" class="btn btn--primary">Solicitar Cotizaci칩n</a>
            </div>
          )}

          <!-- Tech Info -->
          <div class="tech-info">
            <h3 class="tech-info__title">Especificaciones T칠cnicas de V치lvulas de Compuerta OS&Y</h3>
            <div class="tech-info__grid">
              <div class="tech-info__item">
                <span class="tech-info__label">Presi칩n de trabajo</span>
                <span class="tech-info__value">175-350 PSI</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Presi칩n de prueba</span>
                <span class="tech-info__value">4x presi칩n trabajo</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Di치metros disponibles</span>
                <span class="tech-info__value">2.5" a 12"</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Rotaci칩n v치stago</span>
                <span class="tech-info__value">90춿 sello herm칠tico</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Recubrimiento</span>
                <span class="tech-info__value">Ep칩xico AWWA C550</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Certificaciones</span>
                <span class="tech-info__value">UL 262, FM 1120/1130</span>
              </div>
            </div>
          </div>

          <!-- CTA Final -->
          <div class="subcat-cta-final">
            <div class="subcat-cta-final__content">
              <h3 class="subcat-cta-final__title">쯅o encuentras el di치metro o configuraci칩n que necesitas?</h3>
              <p class="subcat-cta-final__desc">Tenemos acceso al cat치logo completo de Elkhart Brass. Cont치ctanos para v치lvulas en di치metros especiales, conexiones bridadas, ranuradas o combinaciones.</p>
            </div>
            <a href="#cotizar" class="btn btn--primary">Solicitar Cotizaci칩n Especial</a>
          </div>
        </main>

        <!-- SIDEBAR -->
        <ProductSidebar
          navTitulo="Tipos de V치lvulas"
          subcategorias={subcategorias}
          baseUrl="/valvulas"
          backLinkHref="/valvulas-contra-incendios"
          backLinkTexto="Ver todas las v치lvulas"
          certificaciones={[
            { siglas: "FM", nombre: "Factory Mutual" },
            { siglas: "UL", nombre: "UL Listed" },
            { siglas: "NOM", nombre: "NOM-002-STPS" }
          ]}
          marcas={["Nibco", "Kennedy", "Milwaukee", "Apollo"]}
          aplicaciones={[
            "Redes hidr치ulicas",
            "Sistemas contra incendio",
            "Plantas industriales",
            "Control de flujo principal"
          ]}
          productosRelacionados={[
            { href: "/gabinetes-hidrantes-contra-incendios", nombre: "Gabinetes e Hidrantes" },
            { href: "/mangueras-contra-incendios", nombre: "Mangueras Contra Incendios" },
            { href: "/boquillas-contra-incendios", nombre: "Boquillas Contra Incendios" },
            { href: "/conexiones-herrajes-contra-incendios", nombre: "Conexiones y Herrajes" }
          ]}
        />

      </div>
    </div>
  </section>

  <!-- RELATED PRODUCTS -->
  <RelatedProductsGrid
    titulo="Otras V치lvulas Contra Incendios"
    subtitulo="Explora m치s opciones para tu sistema de protecci칩n"
    productos={otrosProductos}
    maxProductos={3}
    verTodosLink="/valvulas-contra-incendios"
    verTodosTexto="Ver todas las v치lvulas"
  />

  <CotizacionForm
    titulo="Cotiza V치lvulas de Compuerta"
    tipoEquipo="V치lvulas"
    pagina="V치lvulas de Compuerta"
  />

</Layout>
