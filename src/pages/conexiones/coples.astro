---
import Layout from '../../layouts/Base.astro';
import '../../styles/subcategory.css';
import { getCollection } from 'astro:content';
import SubcategoryProductCard from '../../components/SubcategoryProductCard.astro';
import ProductSidebar from '../../components/ProductSidebar.astro';
import RelatedProductsGrid from '../../components/RelatedProductsGrid.astro';
import CotizacionForm from '../../components/CotizacionForm.astro';

// 1. Obtener todos los productos de la categor칤a conexiones-herrajes
const todosProductos = (await getCollection('productos', ({ data }) =>
  data.categoria === 'conexiones-herrajes'
)).sort((a, b) => a.data.orden - b.data.orden);

// 2. Filtrar por subcategor칤a: Coples y Reducciones
const productosSubcategoria = todosProductos.filter(p => p.data.subcategoria === 'coples');

// 3. Obtener otros productos para secci칩n de relacionados
const otrosProductos = todosProductos.filter(p => !productosSubcategoria.includes(p));

// 4. Definir subcategor칤as para navegaci칩n
const subcategorias = [
  { slug: 'adaptadores', nombre: 'Adaptadores de Bronce', descripcion: 'Conversi칩n entre roscas NH, NPT, Storz', activo: false },
  { slug: 'wye', nombre: 'Conexi칩n Y (Wye)', descripcion: 'Derivaci칩n en dos salidas', activo: false },
  { slug: 'siamesa', nombre: 'Toma Siamesa FDC', descripcion: 'Conexi칩n para bomberos', activo: false },
  { slug: 'coples', nombre: 'Coples y Reducciones', descripcion: 'Conexi칩n r치pida Storz', activo: true },
  { slug: 'chiflones', nombre: 'Chiflones de Tres Pasos', descripcion: 'Control de patr칩n de descarga', activo: false },
  { slug: 'accesorios', nombre: 'Accesorios y Herrajes', descripcion: 'Tapones, caps, niples', activo: false },
];
---

<Layout
  title="Coples Storz y Reducciones Cuarto de Vuelta | M칠xico"
  description="Coples Storz de conexi칩n r치pida cuarto de vuelta y reducciones swivel. Aluminio o bronce. Despliegue 50% m치s r치pido. UL/FM. M칠xico."
  activePage="equipos"
  heroTitle="Coples Storz y Reducciones"
  heroIntro="Acoples de conexi칩n r치pida tipo Storz que permiten unir mangueras con un simple cuarto de vuelta, reduciendo hasta 50% el tiempo de despliegue en emergencias. Sistema sim칠trico que elimina la distinci칩n macho/hembra para conexiones m치s r치pidas."
  heroBadge="Conexiones y Herrajes"
  heroMetrics={[
    { valor: "1/4", texto: "Vuelta conexi칩n" },
    { valor: "50%", texto: "M치s r치pido" },
    { valor: "Al/Br", texto: "Materiales" }
  ]}
  heroPrimaryText="Ver Cat치logo"
  heroPrimaryLink="#catalogo"
  heroSecondaryText="Solicitar Cotizaci칩n"
  heroSecondaryLink="#cotizar"
  heroShowRightContent={true}
>

  <!-- HERO CONTENT -->
  <Fragment slot="hero-content">
    <p>Los <strong>coples Storz</strong> son el est치ndar internacional para conexi칩n r치pida de mangueras contra incendio. Su dise침o sim칠trico permite que cualquier cople se conecte con otro sin importar la orientaci칩n, eliminando los segundos cr칤ticos que se pierden buscando el extremo macho o hembra. El mecanismo de cuarto de vuelta asegura una conexi칩n herm칠tica que resiste presiones de hasta 300 PSI sin fugas.</p>
    <p><strong>Gama de M칠xico</strong> ofrece coples Storz en aluminio forjado para aplicaciones de peso ligero y en bronce fundido para instalaciones permanentes. Disponibles en di치metros de 1.5" a 5", con adaptadores para conversi칩n desde roscas NH y NPT. Las reducciones swivel permiten conectar mangueras de diferentes calibres manteniendo la flexibilidad del sistema sin puntos de torsi칩n.</p>
  </Fragment>

  <!-- CONTENT + SIDEBAR -->
  <section class="subcat-content">
    <div class="container">
      <div class="subcat-layout">

        <!-- MAIN CONTENT -->
        <main class="subcat-main">
          <div class="catalog-header">
            <div class="catalog-header__text">
              <h2 class="catalog-header__title">Cat치logo de Adaptadores de Bronce</h2>
              <p class="catalog-header__desc">Selecciona el modelo que mejor se adapte a tu instalaci칩n</p>
            </div>
            <div class="catalog-header__count">
              <span class="catalog-header__number">{productosSubcategoria.length}</span>
              <span class="catalog-header__label">producto{productosSubcategoria.length !== 1 ? 's' : ''}</span>
            </div>
          </div>

          <!-- Products Grid -->
          <div class="categories__grid">
            {productosSubcategoria.map((producto) => (
              <SubcategoryProductCard
                title={producto.data.title}
                description={producto.data.description}
                brand={producto.data.marca}
                image={producto.data.imagen}
                productSlug={producto.id}
                flow={producto.data.flujo}
                material={producto.data.material}
                certifications={producto.data.certificaciones}
              />
            ))}
          </div>

          {productosSubcategoria.length === 0 && (
            <div class="catalog-empty">
              <div class="catalog-empty__icon">游댌</div>
              <h3 class="catalog-empty__title">Pr칩ximamente m치s opciones</h3>
              <p class="catalog-empty__text">Estamos agregando m치s adaptadores de diferentes marcas. Solicita una cotizaci칩n personalizada.</p>
              <a href="#cotizar" class="btn btn--primary">Solicitar Cotizaci칩n</a>
            </div>
          )}

          <!-- Tech Info -->
          <div class="tech-info">
            <h3 class="tech-info__title">Especificaciones T칠cnicas de Adaptadores</h3>
            <div class="tech-info__grid">
              <div class="tech-info__item">
                <span class="tech-info__label">Presi칩n de trabajo</span>
                <span class="tech-info__value">250-300 PSI</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Presi칩n de prueba</span>
                <span class="tech-info__value">1,000 PSI</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Di치metros</span>
                <span class="tech-info__value">1" a 6"</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Roscas</span>
                <span class="tech-info__value">NH, NPT, Storz</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Temperatura</span>
                <span class="tech-info__value">-65춿F a 250춿F</span>
              </div>
              <div class="tech-info__item">
                <span class="tech-info__label">Material</span>
                <span class="tech-info__value">Bronce / Aluminio</span>
              </div>
            </div>
          </div>

          <!-- CTA Final -->
          <div class="subcat-cta-final">
            <div class="subcat-cta-final__content">
              <h3 class="subcat-cta-final__title">쯅o encuentras la configuraci칩n que necesitas?</h3>
              <p class="subcat-cta-final__desc">Tenemos acceso al cat치logo completo de Elkhart Brass. Cont치ctanos para adaptadores en roscas especiales o configuraciones personalizadas.</p>
            </div>
            <a href="#cotizar" class="btn btn--primary">Solicitar Cotizaci칩n Especial</a>
          </div>
        </main>

        <!-- SIDEBAR -->
        <ProductSidebar
          navTitulo="Tipos de Conexiones"
          subcategorias={subcategorias}
          baseUrl="/conexiones"
          backLinkHref="/conexiones-herrajes-contra-incendios"
          backLinkTexto="Ver todas las conexiones"
          certificaciones={[
            { siglas: "FM", nombre: "Factory Mutual" },
            { siglas: "UL", nombre: "UL Listed" },
            { siglas: "NOM", nombre: "NOM-002-STPS" }
          ]}
          marcas={["Dixon", "Elkhart Brass", "Harrington", "Action Coupling"]}
          aplicaciones={[
            "Uni칩n de mangueras",
            "Conexiones r치pidas",
            "Sistemas port치tiles",
            "Brigadas industriales"
          ]}
          productosRelacionados={[
            { href: "/gabinetes-hidrantes-contra-incendios", nombre: "Gabinetes e Hidrantes" },
            { href: "/mangueras-contra-incendios", nombre: "Mangueras Contra Incendios" },
            { href: "/valvulas-contra-incendios", nombre: "V치lvulas Contra Incendios" },
            { href: "/boquillas-contra-incendios", nombre: "Boquillas Contra Incendios" }
          ]}
        />

      </div>
    </div>
  </section>

  <!-- RELATED PRODUCTS -->
  <RelatedProductsGrid
    titulo="Otras Conexiones y Herrajes"
    subtitulo="Explora m치s opciones para tu sistema contra incendios"
    productos={otrosProductos}
    maxProductos={3}
    verTodosLink="/conexiones-herrajes-contra-incendios"
    verTodosTexto="Ver todas las conexiones"
  />

  <CotizacionForm
    titulo="Cotiza Coples"
    tipoEquipo="Conexiones y herrajes"
    pagina="Conexiones Coples"
  />

</Layout>
